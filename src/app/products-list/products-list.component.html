<div class="products-list fancy-scrollbar">
  <table
    [trackBy]="trackByFn"
    mat-table
    [dataSource]="products">

    <!-- Product Name Column -->
    <ng-container matColumnDef="product-name">
      <th
        mat-header-cell
        *matHeaderCellDef>
        <div class="product-name-wrapper">
          <span matTooltip="Title of a product on Amazon market">
            Product name
          </span>
        </div>
      </th>
      <td mat-cell *matCellDef="let product">
        <div class="name-wrapper">
          <div class="avatar">
            <img src="../../assets/icons/icon-product.svg" class="product-avatar">
          </div>
          <mat-form-field>
            <input
              matInput
              [value]="product.name || ''"
              maxlength="200"
              #productName
              (blur)="onProductEdit(product, { name: productName.value })"
              (keyup.enter)="onProductEdit(product, { name: productName.value })">
          </mat-form-field>
        </div>
      </td>
    </ng-container>

    <!-- ASIN Column -->
    <ng-container matColumnDef="asin">
      <th
        mat-header-cell
        *matHeaderCellDef
        matTooltip="Amazon Serial Identification Number">
        ASIN
      </th>
      <td mat-cell *matCellDef="let product"> {{product.asin}} </td>
    </ng-container>

    <!-- Retail Health Column -->
    <ng-container matColumnDef="retail-health">
      <th
        mat-header-cell
        *matHeaderCellDef
        matTooltip="Retail Health scoring reflects how well product is described within Amazon guidelines on 1-10">
        RH
      </th>
      <td mat-cell *matCellDef="let product">
        <mat-form-field>
          <input
            matInput
            [value]="product.retailHealth"
            type="number"
            [min]="minRH"
            [max]="maxRH"
            #productRH
            (blur)="onProductEdit(product, { retailHealth: +productRH.value }, productRH)">
        </mat-form-field>
      </td>
    </ng-container>

    <!-- Priority Column -->
    <ng-container matColumnDef="priority">
      <th
        mat-header-cell
        *matHeaderCellDef
        matTooltip="Priority products are on default assigned to all keywords">
        Priority
      </th>
      <td mat-cell *matCellDef="let product">
        <mat-slide-toggle
          [checked]="product.priority"
          (change)="onProductEdit(product, { priority: $event.checked })"></mat-slide-toggle>
      </td>
    </ng-container>

    <ng-container matColumnDef="delete-button">
      <th mat-header-cell *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let product">
        <div class="delete-button">
          <button mat-icon-button (click)="deleteProduct(product.id)"><mat-icon>delete</mat-icon></button>
        </div>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
  </table>
  <app-table-message-row
    message="Add first product"
    [clickable]="true"
    *ngIf="(products.length === 0) && !(isLoading$ | async)"
    (click)="openAddProductsDialog()">
  </app-table-message-row>
</div>
