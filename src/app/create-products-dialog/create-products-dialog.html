<div mat-dialog-title>
  <h1>Add products</h1>

  <button
    class="mat-dialog-title__close-button"
    matDialogClose
    matTooltip="Close dialog"
    aria-label="...">
    <mat-icon
      aria-label="Close">
      close
    </mat-icon>
  </button>
</div>

<div mat-dialog-content>
  <div class="product-input__wrapper">
    <mat-form-field appearance="outline" color="accent" class="product-input">
      <input
        matInput
        #productInput
        (keyup.enter)="addProductByInput(productInput.value); productInput.value = ''"
        (paste)="paste($event)"
        placeholder="Add ASIN codes or paste your product table here">
    </mat-form-field>
    <button
      mat-raised-button
      color="accent"
      class="product-input__button"
      [class.active]="productInput.value"
      [disabled]="!productInput.value"
      (click)="addProductByInput(productInput.value); productInput.value = ''">
      Add
    </button>
  </div>

  <div class="product-list" *ngIf="errorMessage">
    <label class="chosen-products-label error">{{ errorMessage }}</label>
  </div>

  <div class="products-list" id="list-table"
       *ngIf="products.length">
    <label class="chosen-products-label" for="list-table">Chosen products ({{ products.length }})</label>
    <table mat-table [trackBy]="trackByFn" [dataSource]="products">

      <!-- Full product name Column -->
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>
          <span>
            Product name
          </span>
        </th>
        <td mat-cell *matCellDef="let product">
          {{ product.name }}
        </td>
      </ng-container>

      <!-- ASIN Column -->
      <ng-container matColumnDef="asin">
        <th mat-header-cell *matHeaderCellDef>
          <span>
            ASIN
          </span>
        </th>
        <td mat-cell *matCellDef="let product">
          {{ product.asin }}
        </td>
      </ng-container>

      <!-- Retail Health Column -->
      <ng-container matColumnDef="retailHealth">
        <th mat-header-cell *matHeaderCellDef>
          <span>
            RH
          </span>
        </th>
        <td mat-cell *matCellDef="let product">
          <div class="rh-wrapper">
            <span>{{ product.retailHealth || '-'}}</span>
          </div>
        </td>
      </ng-container>

      <ng-container matColumnDef="delete-button">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let product">
          <div class="delete-button-wrapper">
            <button mat-icon-button (click)="deleteProduct(product.asin)">
              <mat-icon>delete</mat-icon>
            </button>
          </div>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>
  </div>

  <div class="product-list" id="excel-mockup" *ngIf="!products.length">
    <label class="chosen-products-label" for="excel-mockup">
      You may select range of cells from your Excel file and paste it in area above.
      <br>
      Remember to define and select headers exactly like on given example.
      <a href="../../assets/ShelfSpend_products_template.xlsx" target="_blank">
        Click here to download an Excel template.
      </a>
    </label>
    <img src="/assets/images/shelfspend_product_excel_mockup.svg" alt="Mockup excel" width="100%">
  </div>
</div>

<div mat-dialog-actions>
  <button
    mat-stroked-button
    color="primary" (click)="closeDialog()">Cancel
  </button>
  <div class="action-buttons">
    <!-- <span>Add products as a (choose one):</span> -->
    <div>
      <button
        mat-raised-button
        (click)="submitForm(productTypes.BRAND)"
        [disabled]="!products.length"
        color="accent">
        Save
      </button>
      <!-- <button
        mat-raised-button
        (click)="submitForm(productTypes.COMPETITOR)"
        [disabled]="!products.length"
        color="accent">
        Competitor
      </button> -->
    </div>
  </div>
</div>
